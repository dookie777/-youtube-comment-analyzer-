<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>KBL Player Performance Analyzer</title>
  <style>
    body {
      background: #121212;
      color: #FFF;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1200px;
      margin: auto;
      padding: 20px;
      box-sizing: border-box;
    }
.tab-content {
  overflow-y: auto;
  height: calc(100vh - 100px);
}

    input, button {
      padding: 8px 15px;
      font-size: 1rem;
      border-radius: 5px;
      border: none;
      margin: 10px;
    }
    button {
      cursor: pointer;
      background-color: #FFA500;
      color: #121212;
      font-weight: bold;
    }
    .player-name {
      font-size: 2rem;
      color: #FFF;
      font-weight: bold;
      margin: 15px 0 5px 0;
      text-align: center;
    }
    .team-name {
      font-size: 1rem;
      color: #FFF;
      margin-bottom: 15px;
      text-align: center;
    }
.stats-container {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 15px;
  margin-top: 20px;
  overflow-y: auto;
  height: calc(100vh - 250px); /* 약간 여유 높이 조정 추천 */
}

.card {
  background-color: rgba(255,255,255,0.05); /* 거의 투명한 흰색 배경 */
  padding: 10px;
  border-radius: 10px;
  text-align: center;
  box-sizing: border-box;
  min-height: 330px; /* 카드 세로 길이 조정 (원하는 길이로 조절 가능) */

}
.card.primary:nth-child(2) {
  min-height: 450px; /* 슈팅 카드만 길이 추가 조정 */
}
.card.primary h3 {
  color: #FFA500; /* 주황색 */
}

.card.secondary h3 {
  color: #88c2dd; /* 하늘색 */
}

.card h3 {
  margin-top: 0;
  margin-bottom: 8px; /* 제목과 테이블 간격 좁힘 */
  border-bottom: none;
  font-size: 1.1rem;
}

table {
  width: 100%;
  border-collapse: collapse;
}

th, td {
  padding: 8px 5px;
  border-bottom: 1px solid rgba(255,255,255,0.2); /* 연한 흰색 라인 */
  font-size: 0.9rem;
}

th {
  font-weight: bold;
  color: #FFF;
}

.highlight {
  font-weight: bold;
  color: #ffd700;
}

/* 카드 크기 및 간격 조정 */
.stats-container {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px; /* 카드 간격 조정 */
  margin-top: 15px;
  overflow-y: auto;
  height: calc(100vh - 250px);
  padding-right: 10px; /* 스크롤바 겹침 방지 여백 */
}


  </style>
</head>
<body>
<div class="container">


<div id="playerSearch">
<div style="text-align:center; margin: 20px 0;">
  <input type="text" id="searchPlayer" placeholder="선수 이름 입력" style="width:250px;height:30px;padding:5px 10px;font-size:1rem;border-radius:5px;border:none;">
  <button onclick="showPlayerStats()" style="height:42px;padding:5px 15px;font-size:0.9rem;font-weight:bold;border-radius:5px;background-color:#88c2dd;color:#121212;border:none;">
    검색
  </button>
</div>
    <div class="player-name" id="playerName">-</div>
    <div class="team-name" id="teamName">-</div>

    <div class="stats-container" id="statsContainer"></div>
  </div>

</div>

<script>

  let originalData = [];

  async function loadPlayersData() {
    const res = await fetch('https://docs.google.com/spreadsheets/d/1ez03AkQt4A5HWmo3jRAV3DOyfKfCU4xiI7XCjLRjwnE/export?format=csv');
    const rows = (await res.text()).split('\n').slice(1);
  originalData = rows
    .map(row => row.split(','))
    .filter(cols => cols.length > 52);  }

function createCard(title, stats, type) {
let cardHTML = `<div class="card ${type}"><h3>${title}</h3><table>`;
  
  // 테이블 헤더 추가
  cardHTML += `<tr>
    <th>지표</th>
    <th>수치</th>
    <th>리그 순위</th>
  </tr>`;

  stats.forEach(stat => {
    cardHTML += `<tr>
      <td class="${stat.highlight ? 'highlight' : ''}">${stat.label}</td>
      <td class="${stat.highlight ? 'highlight' : ''}">${stat.value}</td>
      <td>${stat.rank || '-'}</td>
    </tr>`;
  });

  cardHTML += '</table></div>';
  return cardHTML;
}


function showPlayerStats() {
  const playerNameInput = document.getElementById('searchPlayer').value.trim();
  const playerData = originalData.find(cols => cols[2].trim().toLowerCase().includes(playerNameInput.toLowerCase()));

  if (playerData) {
    document.getElementById('playerName').innerText = playerData[2];
    document.getElementById('teamName').innerText = '(' + playerData[1] + ')';

    const statsContainer = document.getElementById('statsContainer');
    statsContainer.innerHTML = '';

    statsContainer.innerHTML += createCard('기본 정보', [
      {label: '출전 경기 수', value: playerData[3] + '경기', rank: playerData[7] + '위'},
      {label: '평균 출전 시간', value: playerData[4] + '분 ' + playerData[5] + '초', rank: playerData[8] + '위'},
      {label: '총 득점', value: playerData[9] + '점', rank: playerData[11] + '위', highlight: true},
      {label: '평균 득점', value: parseFloat(playerData[10]).toFixed(2) + '점', rank: playerData[12] + '위', highlight: true}
    ], 'primary');

    statsContainer.innerHTML += createCard('슈팅 지표', [
      {label: '평균 FG 시도', value: playerData[15], rank: playerData[18] + '위'},
      {label: '평균 FG 성공', value: playerData[16], rank: playerData[19] + '위'},
      {label: '평균 2P 시도', value: playerData[23], rank: playerData[26] + '위'},
      {label: '평균 2P 성공', value: playerData[24], rank: playerData[27] + '위'},
      {label: '평균 3P 시도', value: playerData[31], rank: playerData[34] + '위'},
      {label: '평균 3P 성공', value: playerData[32], rank: playerData[35] + '위'},
      {label: '평균 FT 시도', value: playerData[39], rank: playerData[42] + '위'},
      {label: '평균 FT 성공', value: playerData[40], rank: playerData[43] + '위'}
    ], 'primary');

    statsContainer.innerHTML += createCard('슈팅 성공률', [
      {label: 'FG%', value: playerData[17], rank: playerData[20] + '위'},
      {label: '2P%', value: playerData[25], rank: playerData[28] + '위'},
      {label: '3P%', value: playerData[33], rank: playerData[36] + '위'},
      {label: 'FT%', value: playerData[41], rank: playerData[44] + '위'}
    ], 'primary');

    statsContainer.innerHTML += createCard('리바운드 지표', [
      {label: '총 리바운드', value: playerData[45], rank: playerData[47] + '위', highlight: true},
      {label: '평균 리바운드', value: parseFloat(playerData[46]).toFixed(2), rank: playerData[48] + '위', highlight: true},
      {label: '공격 리바운드', value: playerData[49], rank: playerData[51] + '위'},
      {label: '평균 공격 리바운드', value: parseFloat(playerData[50]).toFixed(2), rank: playerData[52] + '위'},
      {label: '수비 리바운드', value: playerData[53], rank: playerData[55] + '위'},
      {label: '평균 수비 리바운드', value: parseFloat(playerData[54]).toFixed(2), rank: playerData[56] + '위'}
    ], 'primary');

    statsContainer.innerHTML += createCard('어시스트/스틸/블록 지표', [
      {label: '총 어시스트', value: playerData[57], rank: playerData[59] + '위'},
      {label: '평균 어시스트', value: parseFloat(playerData[58]).toFixed(2), rank: playerData[60] + '위'},
      {label: '총 스틸', value: playerData[61], rank: playerData[63] + '위'},
      {label: '평균 스틸', value: parseFloat(playerData[62]).toFixed(2), rank: playerData[64] + '위'},
      {label: '총 블록', value: playerData[65], rank: playerData[67] + '위'},
      {label: '평균 블록', value: parseFloat(playerData[66]).toFixed(2), rank: playerData[68] + '위'}
    ], 'primary');


statsContainer.innerHTML += createCard('기타 지표', [
  {label: '턴오버', value: playerData[69], rank: playerData[71] + '위'},
  {label: '평균 턴오버', value: parseFloat(playerData[70]).toFixed(2), rank: playerData[72] + '위'},
  {label: '파울', value: playerData[73], rank: playerData[75] + '위'},
  {label: '평균 파울', value: parseFloat(playerData[74]).toFixed(2), rank: playerData[76] + '위'}
], 'primary');


statsContainer.innerHTML += createCard('WinShare 지표', [
  {label: 'WS', value: playerData[77], rank: playerData[81] + '위', highlight: true},
  {label: 'WS/40', value: playerData[78], rank: playerData[82] + '위'},
  {label: 'Offensive WS', value: playerData[79], rank: playerData[83] + '위'},
  {label: 'Defensive WS', value: playerData[80], rank: playerData[84] + '위'}
], 'secondary');


statsContainer.innerHTML += createCard('효율성 지표', [
  {label: 'PER', value: playerData[87], rank: playerData[92] + '위'},
  {label: 'EFF', value: playerData[88], rank: playerData[93] + '위'},
  {label: 'EFF/40', value: playerData[89], rank: playerData[94] + '위'},
  {label: 'Offensive Rating', value: playerData[85], rank: playerData[90] + '위'},
  {label: 'Defensive Rating', value: playerData[86], rank: playerData[91] + '위'},
  {label: 'USG%', value: playerData[97] + '%', rank: playerData[102] + '위'}
], 'secondary');


statsContainer.innerHTML += createCard('2차 슈팅 지표', [
  {label: 'TS%', value: playerData[95], rank: playerData[100] + '위'},
  {label: 'eFG%', value: playerData[96], rank: playerData[101] + '위'},
  {label: '3PAr', value: playerData[98], rank: playerData[103] + '위'},
  {label: 'FTr', value: playerData[99], rank: playerData[104] + '위'}
], 'secondary');


statsContainer.innerHTML += createCard('팀내 비중 지표', [
  {label: 'ORB%', value: playerData[105] + '%', rank: playerData[112] + '위'},
  {label: 'DRB%', value: playerData[106] + '%', rank: playerData[113] + '위'},
  {label: 'TRB%', value: playerData[107] + '%', rank: playerData[114] + '위'},
  {label: 'AST%', value: playerData[108] + '%', rank: playerData[115] + '위'},
  {label: 'STL%', value: playerData[109] + '%', rank: playerData[116] + '위'},
  {label: 'BLK%', value: playerData[110] + '%', rank: playerData[117] + '위'},
  {label: 'TOV%', value: playerData[111] + '%', rank: playerData[118] + '위'}
], 'secondary');


  } else {
    alert('선수를 찾을 수 없습니다.');
  }
}


  window.onload = loadPlayersData;
</script>
</body>
</html>
