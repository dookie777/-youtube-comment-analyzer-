<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Basketball Stats Analyzer</title>
  <style>
    body {
      background: #121212;
      color: #FFF;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1200px;
      margin: auto;
      padding: 20px;
      box-sizing: border-box;
      text-align: center;
    }
    input, button {
      padding: 8px 15px;
      font-size: 1rem;
      border-radius: 5px;
      border: none;
      margin: 10px;
    }
    button {
      cursor: pointer;
      background-color: #FFA500;
      color: #121212;
      font-weight: bold;
    }
    .player-name {
      font-size: 2rem;
      color: #FFF;
      font-weight: bold;
      margin: 15px 0 5px 0;
    }
    .team-name {
      font-size: 1.2rem;
      color: #FFF;
      margin-bottom: 15px;
    }
    .stats-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-top: 20px;
    }
    .card {
      background-color: #1e1e1e;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
    }
    .card h3 {
      margin-top: 0;
      border-bottom: 2px solid #333;
      padding-bottom: 5px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      padding: 8px;
      border-bottom: 1px solid #333;
      text-align: center;
    }
    .highlight {
      font-weight: bold;
      color: #FFF;
    }
  </style>
</head>
<body>
<div class="container">
  <input type="text" id="searchPlayer" placeholder="선수 이름 입력">
  <button onclick="showPlayerStats()">검색</button>

  <div class="player-name" id="playerName">-</div>
  <div class="team-name" id="teamName">-</div>

  <div class="stats-container">
    <div class="card">
      <h3>출전 정보</h3>
      <table>
        <tr><td>경기수</td><td id="games">-</td></tr>
        <tr><td>출전시간</td><td id="time">-</td></tr>
      </table>
    </div>
    <div class="card">
      <h3>득점 정보</h3>
      <table>
        <tr><td class="highlight">총 득점</td><td class="highlight" id="points">-</td></tr>
        <tr><td class="highlight">평균 득점</td><td class="highlight" id="ppg">-</td></tr>
        <tr><td>평균 2P 시도</td><td id="2pa">-</td></tr>
        <tr><td>평균 2P 성공</td><td id="2pm">-</td></tr>
        <tr><td>평균 3P 시도</td><td id="3pa">-</td></tr>
        <tr><td>평균 3P 성공</td><td id="3pm">-</td></tr>
        <tr><td>평균 FT 시도</td><td id="fta">-</td></tr>
        <tr><td>평균 FT 성공</td><td id="ftm">-</td></tr>
      </table>
    </div>
    <div class="card">
      <h3>Winshare</h3>
      <table>
        <tr><td class="highlight">WS</td><td class="highlight" id="ws">-</td></tr>
        <tr><td>OWS</td><td id="ows">-</td></tr>
        <tr><td>DWS</td><td id="dws">-</td></tr>
      </table>
    </div>
  </div>
</div>

<script>
  let originalData = [];

  async function loadPlayersData() {
    const res = await fetch('https://docs.google.com/spreadsheets/d/1ez03AkQt4A5HWmo3jRAV3DOyfKfCU4xiI7XCjLRjwnE/export?format=csv');
    const rows = (await res.text()).split('\n').slice(1);
    originalData = rows.map(row => row.split(','));
  }

  function showPlayerStats() {
    const playerNameInput = document.getElementById('searchPlayer').value.trim();
    const playerData = originalData.find(cols => cols[2].trim() === playerNameInput);

    if (playerData) {
      document.getElementById('playerName').innerText = playerData[2];
      document.getElementById('teamName').innerText = '(' + playerData[1] + ')';
      document.getElementById('games').innerText = playerData[3] + '경기';
      document.getElementById('time').innerText = playerData[4] + '분 ' + playerData[5] + '초';
      document.getElementById('points').innerText = playerData[6] + '점';
      document.getElementById('ppg').innerText = parseFloat(playerData[7]).toFixed(2) + '점';
      document.getElementById('2pa').innerText = playerData[12];
      document.getElementById('2pm').innerText = playerData[11];
      document.getElementById('3pa').innerText = playerData[15];
      document.getElementById('3pm').innerText = playerData[14];
      document.getElementById('fta').innerText = playerData[18];
      document.getElementById('ftm').innerText = playerData[17];
      document.getElementById('ws').innerText = parseFloat(playerData[30]).toFixed(1);
      document.getElementById('ows').innerText = parseFloat(playerData[31]).toFixed(1);
      document.getElementById('dws').innerText = parseFloat(playerData[32]).toFixed(1);
    } else {
      alert('선수를 찾을 수 없습니다.');
    }
  }

  window.onload = loadPlayersData;
</script>
</body>
</html>
